#!/usr/bin/env bash

# имена и директории для сессий
SESSION_HOME="home"
DIR_HOME="$HOME"

SESSION_DOWNLOADS="downloads"
DIR_DOWNLOADS="$HOME/Downloads"

SESSION_WIP="wip"
DIR_WIP="$HOME/Projects/scriptor"

# если сессии ещё нет — создаём, сразу с нужным pwd
if ! tmux has-session -t "$SESSION_HOME" 2>/dev/null; then
  TMUX='' tmux new-session -d -s "$SESSION_HOME" -c "$DIR_HOME"
fi

if ! tmux has-session -t "$SESSION_DOWNLOADS" 2>/dev/null; then
  tmux new-session -d -s "$SESSION_DOWNLOADS" -c "$DIR_DOWNLOADS"
fi

if ! tmux has-session -t "$SESSION_WIP" 2>/dev/null; then
  tmux new-session -d -s "$SESSION_WIP" -c "$DIR_WIP"
fi

default_session_param="${1:-h}"

case "$default_session_param" in
  h)
    session="$SESSION_HOME"
    ;;
  d)
    session="$SESSION_DOWNLOADS"
    ;;
  w)
    session="$SESSION_WIP"
    ;;
  *)
    echo "unknown mode: $default_session_param" >&2
    echo "allowed: h, d, w" >&2
    exit 2
    ;;
esac

# если мы уже внутри tmux — просто переключаемся на первую
if [ -n "$TMUX" ]; then
  tmux switch-client -t "$session"
else
  # если вне tmux — прикрепляемся к первой
  tmux attach-session -t "$session"
fi
